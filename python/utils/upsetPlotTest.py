from collections import OrderedDict


from matplotlib import pyplot as plt

from plots.multiupset import plot

#labels = (['(I) EC activation', '(II) EC/MC interaction', '(III) Foam cell formation', '(IV) SMC activation', '(V) Platelet activation', '(VI) Plaque destabilization'])
#labels = (['(I) EC activation', '(II) EC/MC interaction', '(III) Foam cell formation', '(IV) SMC activation', '(V) Platelet activation', '(VI) Plaque destabilization'])

genes = OrderedDict([('(I) EC activation', {'ATF6', 'CCL2', 'MAPK1', 'NR3C2', 'SELE', 'SPHK1', 'CD40LG', 'RHOA', 'F2', 'HMOX1', 'IL1A', 'PPARG', 'TNFRSF1A', 'TRAF2', 'SELP', 'AGTR1', 'EIF2AK3', 'CRP', 'S1PR1', 'MMP3', 'TNFRSF1B', 'HMGB1', 'TNF', 'F3', 'FOXO1', 'CSF3', 'CXCL12', 'EIF2S1', 'PLVAP', 'GSK3B', 'NOS2', 'NOX4', 'EP300', 'AKT1', 'REL', 'ETS1', 'NOS3', 'CDKN1A', 'ANGPT1', 'CSF2', 'MMP14', 'VCAM1', 'PRKACA', 'ICAM1', 'IL6', 'ITGAV', 'SCARB1', 'GATA3', 'IL10', 'ROCK2', 'RELA', 'PRKCZ', 'IL8', 'ATF4', 'CAV1', 'ERN1', 'STAT3', 'SOCS2', 'MAPK3', 'ESR1', 'PTK2', 'JAK2', 'VWF', 'IFNG', 'MMP1', 'SRC', 'CHUK', 'JUN', 'PRKCB', 'AGER', 'IL1B', 'CXCL3', 'SP1', 'VEGFA', 'CSF1', 'OLR1', 'STAT1', 'PLCG1', 'IKBKB', 'ITGB3', 'IFNB1', 'CREB1', 'CXCL2', 'EGR1', 'PECAM1', 'GATA6', 'PTEN', 'CD40', 'RAC1', 'PPARA', 'MAPK8'}), ('(II) EC/MC interaction', {'SELPLG', 'ITGB1', 'CCL2', 'SIRPA', 'ITGAM', 'IL8', 'SELE', 'CXCR6', 'PIK3CA', 'RHOA', 'CCR2', 'ITGAX', 'THY1', 'CX3CR1', 'IL1A', 'ITGAL', 'STAB1', 'IFNG', 'LTB4R', 'CX3CL1', 'ETS1', 'CXCL16', 'SELP', 'STAT5A', 'VCAM1', 'ITGB2', 'ICAM1', 'ITGA4'}), ('(III) Foam cell formation', {'SREBF2', 'PPARD', 'IL10', 'EDNRB', 'HMGB1', 'XDH', 'RELA', 'SCAP', 'MAPK1', 'PRKCZ', 'PTK2B', 'TNF', 'CPT1A', 'NCOR1', 'SREBF1', 'NR1H3', 'SPI1', 'CD14', 'VEGFA', 'LDLR', 'TRADD', 'TLR2', 'CD36', 'STAT3', 'OLR1', 'LCAT', 'STAT1', 'CPT1B', 'APOA1', 'TNFSF15', 'ADAM17', 'MAP3K7', 'MAPK3', 'NFKBIA', 'PPARG', 'IKBKB', 'AKT1', 'NOX1', 'IFNG', 'ACAT1', 'TNFRSF1A', 'SIRT1', 'PTAFR', 'CYP27A1', 'EGR1', 'IRF3', 'CHUK', 'EDNRA', 'MAPK9', 'MYD88', 'TRAF2', 'EDN1', 'INSR', 'NR3C1', 'CDC42', 'ABCG1', 'SYK', 'ABCA1', 'CCR7', 'TLR4', 'AGTR1', 'TGFB1', 'BIRC5', 'IFNA1', 'SOD1', 'TNFSF14', 'NR1H2', 'TLR9', 'RAC1', 'FABP4', 'PPARA', 'SCARB1', 'IL6', 'MSR1'}), ('(IV) SMC activation', {'CDK4', 'RELA', 'PLAU', 'MAPK1', 'CASP1', 'TNF', 'F3', 'NR4A3', 'IL8', 'CCL11', 'PDGFA', 'CD40LG', 'CDKN2A', 'CEBPD', 'PLAUR', 'RB1', 'RHOA', 'GSK3B', 'MYC', 'HIF1A', 'NOS2', 'AKR1B1', 'CCND1', 'CTNNB1', 'NOX4', 'PDGFB', 'MAPK3', 'IRAK1', 'LRP6', 'PDGFRB', 'AKT1', 'PTPN11', 'PCNA', 'CREB1', 'LTBR', 'CCR3', 'E2F1', 'MMP2', 'APOE', 'PDGFRA', 'MYD88', 'THBS1', 'LRP1', 'TLR4', 'AGTR1', 'CCNE1', 'CD40', 'RAC1', 'IGF1', 'IL6', 'PPARA', 'PRKCD', 'IL1B', 'DCBLD2', 'PTGS2'}), ('(V) Platelet activation', {'VASP', 'CCL5', 'MAPK1', 'PTK2B', 'ITGA2', 'CD40LG', 'FGB', 'VEGFA', 'TLR2', 'CD36', 'CXCL12', 'PRKG1', 'TLR6', 'F2', 'F2R', 'RAP1B', 'MAPK3', 'ITGB3', 'TBXA2R', 'AKT1', 'P2RY1', 'FGA', 'VWF', 'GSN', 'ITGA2B', 'LYN', 'MAP2K4', 'PF4', 'MAPK9', 'MYD88', 'THBS1', 'INSR', 'PIK3CB', 'SELP', 'PPBP', 'P2RY12', 'SYK', 'PTEN', 'F2RL3', 'TLR1', 'TLR4', 'ENTPD1', 'PTGER3', 'PRKCD', 'IL1B'}), ('(VI) Plaque destabilization', {'MMP3', 'IL10', 'ATP2A2', 'MFGE8', 'CCL5', 'CCL2', 'PLAU', 'CASP1', 'TNF', 'FCER1A', 'F3', 'FASLG', 'CD40LG', 'SELE', 'MAP3K1', 'BAX', 'ELK1', 'MMP8', 'VEGFA', 'TGM2', 'SLC9A1', 'CCL4', 'CIITA', 'CD36', 'ERN1', 'STAT1', 'TLR2', 'F2', 'HIF1A', 'NOS2', 'CEBPA', 'NOX4', 'KDR', 'HLA-DRA', 'CTGF', 'NFKBIA', 'IL18', 'PPARG', 'IKBKB', 'MERTK', 'JAK2', 'CXCL10', 'IFNG', 'MMP1', 'IL17A', 'TIMP3', 'ETS1', 'IL12B', 'TIMP1', 'MAP2K6', 'IRAK4', 'MMP2', 'CXCL2', 'APOE', 'COL1A2', 'EGR1', 'FGF2', 'TP53', 'MAPK9', 'PECAM1', 'MYD88', 'COL3A1', 'PON3', 'ABCG1', 'PON2', 'TLR4', 'ABCA1', 'VCAM1', 'DDIT3', 'TGFB1', 'TIMP2', 'ICAM1', 'SOD1', 'MMP13', 'IRF5', 'CXCL1', 'CD40', 'IL6', 'MMP9', 'PPARA', 'MSR1', 'COL1A1', 'IL1B', 'PTGS2'})])
mirnas = OrderedDict([('(I) EC activation', {'miR-590', 'miR-10a', 'miR-199a', 'miR-1185', 'miR-1263a', 'miR-31', 'miR-1256', 'miR-27', 'miR-20a', 'miR-23b', 'miR-221', 'miR-223', 'miR-155', 'miR-126a', 'miR-125b', 'miR-146a', 'miR-21', 'miR-141', 'miR-551b', 'miR-30', 'miR-17', 'miR-181b', 'miR-712', 'miR-34a', 'miR-222', 'miR-149', 'miR-499', 'miR-92a', 'miR-126', 'miR-146b'}), ('(II) EC/MC interaction', {'miR-128', 'miR-194', 'miR-487b', 'miR-30a', 'miR-20b', 'miR-361', 'miR-504', 'miR-199b', 'miR-150', 'miR-146a', 'miR-503', 'miR-29c', 'miR-330', 'miR-153', 'miR-491', 'miR-497', 'miR-322', 'miR-26b', 'miR-377', 'miR-222', 'miR-424', 'miR-106b', 'miR-492', 'miR-93', 'miR-18a', 'miR-142', 'miR-98', 'miR-590', 'miR-181c', 'miR-10a', 'miR-19b', 'miR-25', 'miR-24', 'miR-370', 'miR-31', 'miR-373', 'miR-27b', 'miR-27', 'miR-148a', 'miR-367', 'miR-29a', 'miR-29', 'miR-155', 'miR-22', 'miR-27a', 'miR-138', 'miR-124', 'miR-133a', 'miR-187', 'miR-200b', 'miR-15a', 'miR-193a', 'miR-152', 'miR-16', 'miR-7578', 'miR-132', 'miR-378', 'miR-718', 'miR-199a', 'miR-344b', 'miR-140', 'miR-205', 'miR-148', 'miR-26a', 'miR-374b', 'miR-210', 'miR-144', 'miR-125b', 'miR-30d', 'miR-200a', 'miR-195a', 'miR-21', 'let-7d', 'miR-135a', 'miR-18b', 'miR-127', 'miR-19a', 'miR-181a', 'miR-7', 'miR-29b', 'miR-184', 'miR-451', 'miR-92a', 'miR-146b', 'miR-9', 'miR-203', 'miR-489', 'miR-135b', 'miR-145', 'let-7a', 'miR-432', 'miR-342', 'miR-125a', 'miR-221', 'miR-711', 'miR-223', 'miR-185', 'miR-206', 'miR-92', 'miR-17', 'miR-433', 'miR-192', 'miR-100', 'miR-203a', 'miR-146', 'miR-34a', 'miR-149', 'miR-212', 'miR-454', 'miR-126', 'miR-101', 'miR-299', 'miR-183', 'miR-107'}), ('(III) Foam cell formation', {'miR-181c', 'miR-10a', 'miR-199a', 'miR-19b', 'miR-205', 'let-7a', 'miR-214', 'miR-370', 'miR-365a', 'miR-30a', 'miR-31', 'miR-20b', 'miR-504', 'miR-582', 'miR-20a', 'miR-516a', 'miR-125a', 'let-7g', 'miR-29a', 'miR-29', 'miR-155', 'miR-379', 'miR-125b', 'miR-30c', 'miR-146a', 'miR-185', 'miR-21', 'miR-138', 'miR-365', 'miR-204', 'miR-322', 'miR-30', 'miR-17', 'miR-10b', 'miR-34a', 'miR-29b', 'miR-200b', 'miR-16', 'miR-424', 'miR-873', 'miR-451', 'miR-92a', 'miR-93', 'miR-193b', 'miR-98', 'miR-183'}), ('(IV) SMC activation', {'miR-128', 'miR-375', 'miR-194', 'miR-410', 'miR-26', 'miR-487b', 'miR-302b', 'miR-638', 'miR-30a', 'miR-20b', 'miR-361', 'let-7i', 'miR-208', 'miR-33a', 'miR-300', 'miR-504', 'miR-106a', 'miR-291b', 'miR-23b', 'miR-124a', 'miR-20a', 'miR-539', 'miR-199b', 'miR-150', 'miR-126a', 'miR-191', 'miR-146a', 'miR-503', 'miR-382', 'miR-137', 'miR-199', 'miR-29c', 'miR-320c', 'miR-182', 'miR-338', 'miR-168a', 'miR-330', 'miR-153', 'miR-491', 'miR-497', 'miR-322', 'miR-99a', 'miR-663', 'miR-181b', 'miR-10', 'miR-1908', 'miR-26b', 'miR-302a', 'miR-363', 'miR-377', 'miR-351', 'miR-222', 'miR-494', 'miR-125', 'miR-520a', 'miR-424', 'miR-106b', 'miR-492', 'miR-93', 'miR-18a', 'miR-197', 'miR-134', 'miR-142', 'miR-188', 'miR-98', 'miR-590', 'miR-320b', 'miR-562', 'miR-10a', 'miR-19b', 'miR-573', 'miR-495', 'miR-1185', 'miR-133', 'miR-200c', 'miR-25', 'miR-765', 'miR-24', 'miR-1a', 'miR-1263a', 'miR-370', 'miR-31', 'miR-181', 'miR-27b', 'miR-27', 'miR-28', 'miR-467', 'miR-329', 'let-7g', 'miR-29a', 'miR-29', 'miR-155', 'miR-195', 'miR-122', 'miR-22', 'miR-27a', 'miR-545', 'miR-339', 'miR-874', 'miR-138', 'miR-381', 'miR-139', 'miR-141', 'miR-196a', 'miR-486', 'miR-23a', 'miR-939', 'miR-124', 'miR-519c', 'miR-320d', 'miR-34c', 'miR-133a', 'miR-648', 'miR-200b', 'miR-15a', 'miR-506', 'miR-193a', 'miR-499', 'miR-152', 'miR-16', 'miR-455', 'let-7b', 'miR-542', 'miR-216a', 'miR-193b', 'miR-132', 'miR-378', 'miR-290', 'miR-7641', 'miR-608', 'miR-718', 'miR-199a', 'let-7c', 'miR-200', 'miR-140', 'miR-205', 'miR-365a', 'miR-26a', 'miR-758', 'miR-582', 'miR-210', 'miR-129', 'let-7e', 'miR-516a', 'miR-665', 'miR-320a', 'miR-125b', 'miR-30d', 'miR-195a', 'miR-200a', 'miR-21', 'miR-296', 'miR-451a', 'miR-135a', 'miR-136', 'miR-130', 'miR-15', 'miR-30b', 'miR-18b', 'miR-551b', 'miR-30', 'miR-218', 'miR-19a', 'miR-181a', 'miR-7', 'miR-1228', 'miR-143', 'miR-712', 'miR-29b', 'miR-148b', 'miR-429', 'miR-106', 'miR-451', 'miR-92a', 'miR-184', 'miR-4321', 'miR-146b', 'miR-217', 'miR-190a', 'miR-507', 'miR-K', 'miR-9', 'miR-130b', 'miR-624', 'miR-203', 'miR-31a', 'miR-145', 'let-7a', 'miR-211', 'miR-103', 'miR-214', 'miR-640', 'miR-1', 'miR-323', 'miR-302', 'miR-1256', 'miR-320', 'miR-1236', 'miR-33', 'miR-383', 'miR-340', 'miR-133b', 'miR-342', 'miR-130a', 'miR-125a', 'miR-221', 'miR-711', 'miR-223', 'miR-379', 'miR-30c', 'miR-185', 'miR-301a', 'miR-206', 'miR-92', 'miR-335', 'miR-96', 'miR-1283', 'miR-675', 'miR-15b', 'miR-365', 'miR-204', 'miR-17', 'miR-433', 'miR-20', 'miR-192', 'miR-100', 'miR-10b', 'miR-146', 'miR-34a', 'miR-186', 'miR-149', 'miR-331', 'miR-454', 'miR-126', 'miR-101', 'miR-299', 'miR-183', 'miR-107'}), ('(V) Platelet activation', {'miR-590', 'miR-338', 'miR-20a', 'miR-124a', 'miR-98', 'miR-205', 'let-7g', 'let-7a', 'let-7b', 'miR-92a', 'miR-155', 'miR-20', 'miR-369', 'miR-133a', 'miR-143', 'miR-545'}), ('(VI) Plaque destabilization', {'miR-128', 'miR-375', 'miR-410', 'miR-548', 'miR-2909', 'miR-30a', 'miR-20b', 'let-7i', 'miR-504', 'miR-20a', 'miR-124a', 'miR-23b', 'miR-6821', 'miR-34b', 'miR-150', 'miR-126a', 'miR-146a', 'miR-503', 'miR-137', 'miR-182', 'miR-1252', 'miR-663b', 'miR-330', 'miR-491', 'miR-497', 'miR-322', 'miR-181b', 'miR-26b', 'miR-181d', 'miR-6848', 'miR-351', 'miR-222', 'miR-494', 'miR-125', 'miR-520a', 'miR-7156', 'miR-424', 'miR-106b', 'miR-873', 'miR-93', 'miR-4801', 'miR-142', 'miR-98', 'miR-590', 'miR-181c', 'miR-10a', 'miR-19b', 'miR-495', 'miR-200c', 'miR-24', 'miR-1263a', 'miR-370', 'miR-7a', 'miR-31', 'miR-4273', 'miR-27b', 'miR-329', 'let-7g', 'miR-29a', 'miR-29', 'miR-155', 'miR-195', 'miR-122', 'miR-22', 'miR-378a', 'miR-27a', 'miR-346', 'miR-138', 'miR-486', 'miR-23a', 'miR-124', 'miR-34c', 'miR-133a', 'miR-4731', 'miR-200b', 'miR-15a', 'miR-193a', 'miR-580', 'miR-152', 'miR-499', 'miR-16', 'miR-603', 'miR-219b', 'let-7b', 'miR-542', 'miR-103a', 'miR-216a', 'miR-193b', 'miR-132', 'miR-378', 'miR-608', 'miR-6790', 'miR-199a', 'let-7c', 'miR-205', 'miR-34', 'miR-92b', 'miR-365a', 'miR-3646', 'miR-1976', 'miR-26a', 'miR-519d', 'miR-582', 'miR-374b', 'miR-210', 'miR-144', 'miR-516a', 'miR-4516', 'miR-M', 'miR-320a', 'miR-6778', 'miR-125b', 'miR-1277', 'miR-30d', 'miR-92d', 'miR-5011', 'miR-21', 'miR-296', 'miR-731', 'miR-15', 'miR-30b', 'miR-142a', 'miR-18b', 'miR-19a', 'miR-181a', 'miR-5688', 'miR-143', 'miR-148b', 'miR-29b', 'miR-32', 'miR-106', 'miR-184', 'miR-451', 'miR-92a', 'miR-146b', 'miR-190a', 'miR-9', 'miR-130b', 'miR-624', 'miR-202', 'miR-5692a', 'miR-203', 'miR-519a', 'miR-145', 'let-7a', 'miR-641', 'miR-2117', 'miR-103', 'miR-214', 'miR-640', 'miR-6843', 'miR-320', 'miR-33', 'miR-8485', 'miR-3653', 'miR-130a', 'miR-125a', 'miR-221', 'miR-223', 'miR-379', 'miR-30c', 'miR-185', 'miR-1193', 'miR-4457', 'miR-301a', 'miR-96', 'miR-15b', 'miR-372', 'miR-365', 'miR-204', 'miR-298', 'miR-224', 'miR-17', 'miR-518b', 'miR-374a', 'miR-219', 'miR-192', 'miR-10b', 'miR-34a', 'miR-186', 'miR-149', 'miR-3617', 'miR-212', 'miR-126', 'miR-30e', 'miR-183', 'miR-107'})])


#disease
genes = OrderedDict([('(I) EC activation', {'MMP1', 'NOS3', 'IFNB1', 'IL10', 'SRC', 'TNFRSF1A', 'CREB1', 'PRKCB', 'PTEN', 'ESR1', 'AGER', 'ETS1', 'REL', 'PRKCZ', 'ATF6', 'AGTR1', 'F2', 'NOX4', 'SCARB1', 'VWF', 'AKT1', 'CSF3', 'SELP', 'SPHK1', 'CAV1', 'PPARG', 'ITGB3', 'CXCL2', 'MMP14', 'STAT3', 'EGR1', 'ERN1', 'CHUK', 'HMGB1', 'PTK2', 'JUN', 'GATA6', 'IL1A', 'CSF1', 'JAK2', 'VEGFA', 'CDKN1A', 'NOS2', 'ICAM1', 'EIF2S1', 'SOCS2', 'PLVAP', 'PRKACA', 'SELE', 'IL6', 'CD40', 'CSF2', 'MMP3', 'SP1', 'S1PR1', 'HMOX1', 'EP300', 'ROCK2', 'RAC1', 'GSK3B', 'FOXO1', 'TNFRSF1B', 'PECAM1', 'PPARA', 'IKBKB', 'OLR1', 'IL8', 'TRAF2', 'CXCL12', 'CD40LG', 'NR3C2', 'RELA', 'GATA3', 'MAPK3', 'CXCL3', 'ANGPT1', 'VCAM1', 'MAPK8', 'MAPK1', 'STAT1', 'IFNG', 'RHOA', 'ATF4', 'EIF2AK3', 'ITGAV', 'IL1B', 'CCL2', 'CRP', 'F3', 'PLCG1', 'TNF'}), ('(II) EC/MC interaction', {'SELPLG', 'THY1', 'ITGA4', 'CXCR6', 'SELP', 'ITGAX', 'STAB1', 'STAT5A', 'CXCL16', 'SELE', 'ITGAM', 'VCAM1', 'ITGB1', 'IFNG', 'SIRPA', 'ETS1', 'RHOA', 'CCR2', 'IL1A', 'CCL2', 'CX3CR1', 'PIK3CA', 'ITGB2', 'ICAM1', 'CX3CL1', 'ITGAL', 'IL8', 'LTB4R'}), ('(III) Foam cell formation', {'NR1H3', 'ABCG1', 'TNFSF15', 'TLR4', 'SREBF2', 'NCOR1', 'SCAP', 'IL10', 'NOX1', 'CPT1B', 'SOD1', 'EDNRB', 'PPARG', 'ABCA1', 'RELA', 'MAPK3', 'IFNA1', 'MAPK9', 'CYP27A1', 'TNFRSF1A', 'AKT1', 'EDNRA', 'MAPK1', 'IL6', 'ACAT1', 'STAT1', 'INSR', 'APOA1', 'BIRC5', 'TGFB1', 'LDLR', 'TLR9', 'CCR7', 'STAT3', 'PTAFR', 'EGR1', 'SYK', 'IFNG', 'NR1H2', 'EDN1', 'CD14', 'PPARD', 'SIRT1', 'SPI1', 'CHUK', 'MSR1', 'MAP3K7', 'NR3C1', 'LCAT', 'PRKCZ', 'NFKBIA', 'TRADD', 'SREBF1', 'XDH', 'TLR2', 'HMGB1', 'TNFSF14', 'FABP4', 'VEGFA', 'CD36', 'AGTR1', 'CDC42', 'RAC1', 'PTK2B', 'CPT1A', 'MYD88', 'PPARA', 'IKBKB', 'SCARB1', 'ADAM17', 'OLR1', 'IRF3', 'TRAF2', 'TNF'}), ('(IV) SMC activation', {'CCR3', 'PDGFA', 'PLAUR', 'PDGFB', 'E2F1', 'AKR1B1', 'DCBLD2', 'TLR4', 'CD40LG', 'F3', 'LRP1', 'APOE', 'THBS1', 'PRKCD', 'CCNE1', 'NR4A3', 'PTGS2', 'CCL11', 'CASP1', 'RELA', 'MAPK3', 'CREB1', 'PTPN11', 'CEBPD', 'PCNA', 'LRP6', 'MAPK1', 'IL6', 'CD40', 'CDK4', 'MYC', 'IRAK1', 'CTNNB1', 'CCND1', 'RHOA', 'HIF1A', 'MMP2', 'CDKN2A', 'IL1B', 'AGTR1', 'NOX4', 'RAC1', 'PDGFRA', 'PLAU', 'GSK3B', 'MYD88', 'PPARA', 'NOS2', 'PDGFRB', 'LTBR', 'IGF1', 'RB1', 'IL8', 'AKT1', 'TNF'}), ('(V) Platelet activation', {'CXCL12', 'PPBP', 'TLR4', 'CD40LG', 'SELP', 'PF4', 'TLR6', 'THBS1', 'PRKCD', 'ENTPD1', 'ITGB3', 'MAPK3', 'F2RL3', 'MAPK9', 'MAPK1', 'CCL5', 'INSR', 'PTEN', 'PTGER3', 'PIK3CB', 'P2RY1', 'SYK', 'ITGA2B', 'P2RY12', 'ITGA2', 'FGA', 'VASP', 'TLR2', 'PRKG1', 'RAP1B', 'VEGFA', 'MAP2K4', 'CD36', 'GSN', 'F2', 'PTK2B', 'TBXA2R', 'MYD88', 'FGB', 'TLR1', 'F2R', 'IL1B', 'LYN', 'VWF', 'AKT1'}), ('(VI) Plaque destabilization', {'MMP1', 'PON2', 'KDR', 'ABCG1', 'TLR4', 'MERTK', 'CD40LG', 'IRAK4', 'FGF2', 'IL10', 'MAP3K1', 'ATP2A2', 'FASLG', 'CIITA', 'APOE', 'MMP8', 'SOD1', 'PTGS2', 'COL1A1', 'CCL4', 'TGM2', 'TIMP3', 'ABCA1', 'BAX', 'CASP1', 'PPARG', 'CXCL2', 'MAPK9', 'VCAM1', 'SELE', 'IL18', 'MMP9', 'IL6', 'STAT1', 'CD40', 'COL1A2', 'TGFB1', 'COL3A1', 'TIMP2', 'CXCL10', 'IFNG', 'EGR1', 'IL12B', 'ERN1', 'ETS1', 'ELK1', 'MMP3', 'MSR1', 'TP53', 'MFGE8', 'CEBPA', 'HIF1A', 'NFKBIA', 'FCER1A', 'IL17A', 'TLR2', 'MMP2', 'IRF5', 'IL1B', 'CCL2', 'VEGFA', 'JAK2', 'TIMP1', 'MMP13', 'CD36', 'CXCL1', 'PON3', 'F2', 'HLA-DRA', 'NOX4', 'CTGF', 'PLAU', 'NOS2', 'DDIT3', 'PPARA', 'ICAM1', 'SLC9A1', 'MYD88', 'PECAM1', 'MAP2K6', 'F3', 'IKBKB', 'CCL5', 'TNF'})])
#mirnas = OrderedDict([('(I) EC activation', {'miR-21', 'miR-141', 'miR-181b', 'miR-126', 'miR-10a', 'miR-155', 'miR-221', 'miR-125b', 'miR-499', 'miR-1185', 'miR-27', 'miR-222', 'miR-223', 'miR-712'}), ('(II) EC/MC interaction', {'miR-21', 'miR-194', 'miR-126', 'miR-125b', 'miR-124', 'miR-370', 'miR-377', 'miR-140', 'miR-152', 'miR-155', 'miR-29a', 'miR-203', 'miR-34a', 'miR-145', 'miR-31', 'miR-125a', 'miR-150', 'miR-93', 'miR-146a', 'miR-181c', 'miR-433', 'miR-342', 'miR-206', 'miR-27', 'miR-222', 'miR-210', 'miR-497'}), ('(III) Foam cell formation', {'miR-21', 'miR-17', 'miR-125b', 'miR-370', 'miR-16', 'miR-504', 'miR-214', 'miR-30c', 'let-7g', 'miR-185', 'miR-199a', 'miR-34a', 'miR-31', 'miR-138', 'miR-125a', 'let-7a', 'miR-204', 'miR-93', 'miR-146a', 'miR-181c', 'miR-98', 'miR-424', 'miR-516a'}), ('(IV) SMC activation', {'miR-590', 'miR-29b', 'miR-126', 'miR-939', 'miR-124', 'miR-370', 'miR-504', 'miR-126a', 'miR-214', 'miR-30c', 'let-7g', 'miR-199', 'miR-20', 'miR-491', 'miR-339', 'miR-23b', 'miR-331', 'miR-29a', 'miR-136', 'miR-291b', 'miR-133a', 'miR-361', 'miR-24', 'miR-138', 'miR-383', 'miR-125a', 'miR-150', 'miR-93', 'miR-204', 'miR-181', 'miR-433', 'miR-495', 'miR-410', 'miR-98', 'miR-338', 'miR-222', 'miR-200b', 'miR-1', 'miR-638', 'miR-492', 'miR-152', 'miR-503', 'miR-10a', 'miR-132', 'miR-20a', 'miR-99a', 'miR-185', 'miR-146', 'miR-199a', 'miR-18a', 'miR-648', 'miR-351', 'let-7a', 'miR-181a', 'miR-103', 'miR-129', 'miR-455', 'miR-92a', 'miR-27', 'miR-223', 'miR-486', 'miR-516a', 'miR-181b', 'miR-107', 'miR-27b', 'miR-125b', 'miR-33a', 'miR-377', 'miR-499', 'miR-10b', 'miR-712', 'miR-758', 'miR-195', 'miR-545', 'miR-155', 'miR-106b', 'miR-28', 'miR-203', 'miR-34a', 'miR-26b', 'miR-130', 'miR-9', 'miR-205', 'miR-216a', 'miR-141', 'miR-454', 'miR-15b', 'miR-19b', 'miR-424', 'miR-26a', 'miR-217', 'miR-497', 'miR-21', 'miR-17', 'miR-16', 'miR-124a', 'miR-33', 'miR-140', 'miR-130a', 'miR-1185', 'miR-27a', 'miR-301a', 'miR-15a', 'miR-142', 'miR-100', 'miR-200c', 'let-7b', 'miR-31a', 'miR-145', 'miR-22', 'miR-143', 'miR-15', 'miR-19a', 'miR-146a', 'miR-221', 'miR-206', 'miR-133', 'miR-192', 'miR-210', 'miR-365'}), ('(V) Platelet activation', {'let-7a', 'miR-590', 'miR-545', 'let-7g', 'miR-20', 'miR-20a', 'miR-98', 'miR-133a', 'miR-338', 'miR-124a', 'miR-92a', 'miR-143', 'miR-205', 'let-7b'}), ('(VI) Plaque destabilization', {'miR-21', 'miR-17', 'miR-590', 'miR-126', 'miR-125b', 'miR-494', 'miR-370', 'miR-16', 'miR-499', 'miR-504', 'miR-33', 'miR-214', 'miR-195', 'miR-30c', 'let-7g', 'miR-132', 'miR-155', 'miR-130a', 'miR-185', 'miR-199a', 'miR-106b', 'miR-7a', 'miR-200c', 'miR-34a', 'miR-23a', 'miR-103a', 'miR-22', 'miR-351', 'miR-24', 'miR-138', 'miR-31', 'miR-125a', 'let-7a', 'miR-204', 'miR-150', 'miR-146a', 'miR-181c', 'miR-93', 'miR-181a', 'miR-495', 'miR-221', 'miR-98', 'miR-424', 'miR-26a', 'miR-92a', 'miR-497', 'miR-516a', 'let-7b'})])



import pandas as pd
import numpy as np

def make_data(indata):




    n_sets = len(indata)

    unionElems = set()
    for x in indata:
        unionElems = unionElems.union(set(indata[x]))

    unionElems = tuple(unionElems)
    n_samples = len(unionElems)

    setLabels = [x for x in indata]
    rng = np.random.RandomState(0)
    df = pd.DataFrame({'value': np.zeros(n_samples)})
    for i in range(len(setLabels)):

        r = []
        for x in unionElems:
            if x in indata[setLabels[i]]:
                r.append(True)
            else:
                r.append(False)

        df[setLabels[i]] = r
        df['value'] += r

    df.set_index([setLabels[i] for i in range(n_sets)], inplace=True)

    return df.value.groupby(level=list(range(n_sets))).count()



ndata = make_data(mirnas)

plot( ndata, sort_by='degree', sort_sets_by =None, orientation="vertical" )
plt.tight_layout()

plt.savefig("/mnt/d/owncloud/markus/uni/publications/miReview/stages_mir_overlap_upset.pdf")

plt.show()